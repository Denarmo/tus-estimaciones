function main(){return"http:"==location.protocol?(alert("Reddireccionando a HTTPS para acceder al mapa..."),void location.replace("https://"+location.host+location.pathname)):(map=new google.maps.Map(document.getElementById("map"),{center:{lat:43.462068,lng:-3.810204},zoom:17}),setLocation(),void downloadStops())}function setLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){console.log("Latitude",a.coords.latitude),console.log("Longitude",a.coords.longitude);var o=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);map.setCenter(o)},function(){alert("Error de geolocalización. Verifique que su localización esté activada para usar esta función.")}):alert("Error de geolocalización. Verifique que su localización esté activada para usar esta función.")}function downloadStops(){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState){if(200!=this.status)return void alert("Error descargando los datos de paradas.");var a=null;try{a=JSON.parse(this.responseText)}catch(a){return void alert("Error descargando los datos de paradas.")}if(!Array.isArray(a))return void alert("Error descargando los datos de paradas.");for(var o=0;o<a.length;o++){var e=a[o];if(4===e.length){var t=new google.maps.Marker({position:{lat:e[1],lng:e[2]},map:map,title:e[3],icon:"/images/marker-min.png",stopId:e[0],stopName:e[3]}),n=new google.maps.InfoWindow;google.maps.event.addListener(t,"click",function(a,o){return function(){n.setContent('<div class="marker-link"><a href="http://'+location.host+"/?parada="+a.stopId+'&estimaciones=true">'+a.stopName+"</a></div>"),n.open(map,a)}}(t,o))}else console.error("Invalid data length.")}}},a.open("GET","https://"+location.host+STOPS_PATH,!0),a.send()}var STOPS_PATH="/json/paradas-bus.min.json",map=null;google.maps.event.addDomListener(window,"load",main);